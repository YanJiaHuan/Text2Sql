import openai
import tiktoken
import os
MAX_TOKENS = 4096
# model_name = "gpt-3.5-turbo"
# model_name = "gpt-4"
model_name = "gpt-3.5-turbo-16k"
encoding = tiktoken.encoding_for_model(model_name)


# API_KEY = "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" # 自己的
API_KEY = "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"  # 买的
# API_KEY = "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" # gpt4 孙哥
os.environ["OPENAI_API_KEY"] = API_KEY
openai.api_key = os.getenv("OPENAI_API_KEY")
def GPT4_generation(prompt):
    '''
    openai.error.RateLimitError: Rate limit reached for default-gpt-3.5-turbo
    in organization org-GFmlumrCZBB2Y40fVv7f8qgp on requests per min. Limit: 3 / min.
    Please try again in 20s. Contact us through our help center at help.openai.com if you continue to have issues.
    Please add a payment method to your account to increase your rate limit.
    Visit https://platform.openai.com/account/billing to add a payment method.
    '''
    response = openai.ChatCompletion.create(
        model=model_name,
        messages=[{"role": "user", "content": prompt}],
        n = 1,
        stream = False,
        temperature=0.0,
        max_tokens=600,
        top_p = 1.0,
        frequency_penalty=0.0,
        presence_penalty=0.0,
    )
    return response['choices'][0]['message']['content']

message = '''
          "Database stats: {'law': {'avg_tokens': 78.0057361376673, 'num_tables': 30, 'num_columns': 235, 'condition_count': {'orderBy': 81, 'groupBy': 239, 'having': 94, 'nested': 37, 'join': 484}}, 'thriller_novels': {'avg_tokens': 78.9419795221843, 'num_tables': 19, 'num_columns': 78, 'condition_count': {'orderBy': 35, 'groupBy': 139, 'having': 108, 'nested': 18, 'join': 288}}, 'fitness': {'avg_tokens': 73.64882943143813, 'num_tables': 22, 'num_columns': 127, 'condition_count': {'orderBy': 66, 'groupBy': 225, 'having': 4, 'nested': 81, 'join': 279}}, 'copywriting': {'avg_tokens': 51.48913043478261, 'num_tables': 12, 'num_columns': 45, 'condition_count': {'orderBy': 16, 'groupBy': 70, 'having': 30, 'nested': 2, 'join': 91}}, 'public_relations': {'avg_tokens': 63.68518518518518, 'num_tables': 44, 'num_columns': 240, 'condition_count': {'orderBy': 7, 'groupBy': 14, 'having': 8, 'nested': 17, 'join': 461}}, 'music': {'avg_tokens': 81.69047619047619, 'num_tables': 11, 'num_columns': 43, 'condition_count': {'orderBy': 34, 'groupBy': 224, 'having': 150, 'nested': 146, 'join': 250}}, 'project_management': {'avg_tokens': 61.624605678233436, 'num_tables': 26, 'num_columns': 181, 'condition_count': {'orderBy': 46, 'groupBy': 220, 'having': 13, 'nested': 62, 'join': 544}}, 'psychotherapy': {'avg_tokens': 91.22185430463576, 'num_tables': 9, 'num_columns': 66, 'condition_count': {'orderBy': 82, 'groupBy': 166, 'having': 51, 'nested': 48, 'join': 293}}, 'nursing': {'avg_tokens': 79.61953727506426, 'num_tables': 35, 'num_columns': 180, 'condition_count': {'orderBy': 30, 'groupBy': 57, 'having': 18, 'nested': 53, 'join': 363}}, 'philosophy': {'avg_tokens': 114.70414201183432, 'num_tables': 12, 'num_columns': 51, 'condition_count': {'orderBy': 0, 'groupBy': 14, 'having': 14, 'nested': 22, 'join': 166}}, 'education': {'avg_tokens': 66.6, 'num_tables': 26, 'num_columns': 68, 'condition_count': {'orderBy': 18, 'groupBy': 144, 'having': 89, 'nested': 72, 'join': 178}}, 'event_management': {'avg_tokens': 89.98163265306123, 'num_tables': 44, 'num_columns': 235, 'condition_count': {'orderBy': 187, 'groupBy': 345, 'having': 34, 'nested': 41, 'join': 434}}, 'personal_training': {'avg_tokens': 89.56218905472637, 'num_tables': 73, 'num_columns': 339, 'condition_count': {'orderBy': 46, 'groupBy': 179, 'having': 95, 'nested': 20, 'join': 357}}, 'finance': {'avg_tokens': 26.474537037037038, 'num_tables': 34, 'num_columns': 306, 'condition_count': {'orderBy': 7, 'groupBy': 25, 'having': 2, 'nested': 20, 'join': 31}}, 'painting': {'avg_tokens': 98.07296137339056, 'num_tables': 23, 'num_columns': 133, 'condition_count': {'orderBy': 5, 'groupBy': 9, 'having': 5, 'nested': 110, 'join': 461}}, 'comedy_films': {'avg_tokens': 103.91037735849056, 'num_tables': 22, 'num_columns': 38, 'condition_count': {'orderBy': 5, 'groupBy': 180, 'having': 164, 'nested': 209, 'join': 185}}, 'food_and_drink_books': {'avg_tokens': 79.81553398058253, 'num_tables': 23, 'num_columns': 33, 'condition_count': {'orderBy': 2, 'groupBy': 22, 'having': 17, 'nested': 16, 'join': 101}}, 'western_films': {'avg_tokens': 84.76744186046511, 'num_tables': 34, 'num_columns': 100, 'condition_count': {'orderBy': 60, 'groupBy': 56, 'having': 14, 'nested': 12, 'join': 113}}, 'forensic_psychology': {'avg_tokens': 76.35258358662614, 'num_tables': 49, 'num_columns': 255, 'condition_count': {'orderBy': 16, 'groupBy': 61, 'having': 10, 'nested': 71, 'join': 263}}, 'shipping_and_logistics': {'avg_tokens': 59.16417910447761, 'num_tables': 19, 'num_columns': 58, 'condition_count': {'orderBy': 11, 'groupBy': 60, 'having': 13, 'nested': 71, 'join': 86}}, 'science_fiction_films': {'avg_tokens': 68.64588528678304, 'num_tables': 26, 'num_columns': 56, 'condition_count': {'orderBy': 100, 'groupBy': 245, 'having': 124, 'nested': 139, 'join': 357}}, 'mobile_app_development': {'avg_tokens': 41.57575757575758, 'num_tables': 18, 'num_columns': 133, 'condition_count': {'orderBy': 15, 'groupBy': 17, 'having': 4, 'nested': 80, 'join': 311}}, 'travel': {'avg_tokens': 67.49659863945578, 'num_tables': 42, 'num_columns': 230, 'condition_count': {'orderBy': 46, 'groupBy': 55, 'having': 3, 'nested': 3, 'join': 134}}, 'business_intelligence': {'avg_tokens': 62.399253731343286, 'num_tables': 30, 'num_columns': 253, 'condition_count': {'orderBy': 14, 'groupBy': 130, 'having': 66, 'nested': 37, 'join': 464}}, 'accounting': {'avg_tokens': 42.649289099526065, 'num_tables': 41, 'num_columns': 246, 'condition_count': {'orderBy': 144, 'groupBy': 136, 'having': 14, 'nested': 19, 'join': 237}}, 'fictional_art': {'avg_tokens': 45.570754716981135, 'num_tables': 27, 'num_columns': 182, 'condition_count': {'orderBy': 14, 'groupBy': 45, 'having': 18, 'nested': 40, 'join': 147}}, 'user_experience_(ux)_design': {'avg_tokens': 44.04448742746615, 'num_tables': 26, 'num_columns': 176, 'condition_count': {'orderBy': 4, 'groupBy': 159, 'having': 19, 'nested': 130, 'join': 240}}, 'health_and_wellness_programs': {'avg_tokens': 92.60196078431373, 'num_tables': 35, 'num_columns': 153, 'condition_count': {'orderBy': 198, 'groupBy': 336, 'having': 108, 'nested': 35, 'join': 448}}, 'industrial_design': {'avg_tokens': 31.670212765957448, 'num_tables': 22, 'num_columns': 119, 'condition_count': {'orderBy': 14, 'groupBy': 22, 'having': 4, 'nested': 26, 'join': 34}}, 'network_security': {'avg_tokens': 79.57603686635944, 'num_tables': 18, 'num_columns': 169, 'condition_count': {'orderBy': 79, 'groupBy': 1, 'having': 1, 'nested': 0, 'join': 189}}, 'user_interface_design': {'avg_tokens': 55.40972222222222, 'num_tables': 21, 'num_columns': 137, 'condition_count': {'orderBy': 39, 'groupBy': 187, 'having': 63, 'nested': 167, 'join': 228}}, 'cooking_shows': {'avg_tokens': 48.329787234042556, 'num_tables': 24, 'num_columns': 49, 'condition_count': {'orderBy': 5, 'groupBy': 90, 'having': 72, 'nested': 35, 'join': 145}}, 'hypnotherapy': {'avg_tokens': 72.82211538461539, 'num_tables': 26, 'num_columns': 166, 'condition_count': {'orderBy': 163, 'groupBy': 227, 'having': 41, 'nested': 34, 'join': 349}}, 'operations_management': {'avg_tokens': 63.74, 'num_tables': 51, 'num_columns': 329, 'condition_count': {'orderBy': 119, 'groupBy': 207, 'having': 57, 'nested': 27, 'join': 505}}, 'cybersecurity': {'avg_tokens': 65.7202380952381, 'num_tables': 51, 'num_columns': 260, 'condition_count': {'orderBy': 35, 'groupBy': 25, 'having': 14, 'nested': 4, 'join': 277}}, 'cooking': {'avg_tokens': 62.67479674796748, 'num_tables': 16, 'num_columns': 53, 'condition_count': {'orderBy': 11, 'groupBy': 80, 'having': 63, 'nested': 32, 'join': 118}}, 'homeopathy': {'avg_tokens': 62.77325581395349, 'num_tables': 10, 'num_columns': 43, 'condition_count': {'orderBy': 0, 'groupBy': 1, 'having': 0, 'nested': 13, 'join': 105}}, 'civil_engineering': {'avg_tokens': 71.6875, 'num_tables': 44, 'num_columns': 233, 'condition_count': {'orderBy': 16, 'groupBy': 103, 'having': 35, 'nested': 54, 'join': 509}}, 'game_shows': {'avg_tokens': 111.21985815602837, 'num_tables': 22, 'num_columns': 75, 'condition_count': {'orderBy': 2, 'groupBy': 131, 'having': 113, 'nested': 74, 'join': 140}}, 'jazz': {'avg_tokens': 80.78853046594982, 'num_tables': 28, 'num_columns': 49, 'condition_count': {'orderBy': 0, 'groupBy': 95, 'having': 95, 'nested': 277, 'join': 0}}, 'sculpting': {'avg_tokens': 94.89001692047377, 'num_tables': 28, 'num_columns': 63, 'condition_count': {'orderBy': 10, 'groupBy': 69, 'having': 52, 'nested': 146, 'join': 584}}, 'computer_engineering': {'avg_tokens': 57.48913043478261, 'num_tables': 22, 'num_columns': 59, 'condition_count': {'orderBy': 7, 'groupBy': 64, 'having': 52, 'nested': 61, 'join': 62}}, 'email_marketing': {'avg_tokens': 79.49731182795699, 'num_tables': 19, 'num_columns': 116, 'condition_count': {'orderBy': 61, 'groupBy': 116, 'having': 6, 'nested': 90, 'join': 261}}, 'retail': {'avg_tokens': 59.81981981981982, 'num_tables': 28, 'num_columns': 57, 'condition_count': {'orderBy': 12, 'groupBy': 93, 'having': 47, 'nested': 24, 'join': 103}}, 'triathlon': {'avg_tokens': 54.492063492063494, 'num_tables': 10, 'num_columns': 42, 'condition_count': {'orderBy': 26, 'groupBy': 45, 'having': 11, 'nested': 3, 'join': 59}}, 'industrial_engineering': {'avg_tokens': 70.21212121212122, 'num_tables': 18, 'num_columns': 65, 'condition_count': {'orderBy': 44, 'groupBy': 43, 'having': 33, 'nested': 22, 'join': 48}}, 'food_and_drink': {'avg_tokens': 50.36065573770492, 'num_tables': 37, 'num_columns': 221, 'condition_count': {'orderBy': 127, 'groupBy': 77, 'having': 9, 'nested': 216, 'join': 212}}, 'cognitive_psychology': {'avg_tokens': 88.24096385542168, 'num_tables': 20, 'num_columns': 53, 'condition_count': {'orderBy': 29, 'groupBy': 82, 'having': 38, 'nested': 4, 'join': 82}}, 'smart_transportation': {'avg_tokens': 43.25833333333333, 'num_tables': 15, 'num_columns': 43, 'condition_count': {'orderBy': 23, 'groupBy': 90, 'having': 12, 'nested': 7, 'join': 110}}, 'environment': {'avg_tokens': 75.4055944055944, 'num_tables': 42, 'num_columns': 231, 'condition_count': {'orderBy': 178, 'groupBy': 45, 'having': 0, 'nested': 0, 'join': 279}}, 'technology': {'avg_tokens': 70.96703296703296, 'num_tables': 15, 'num_columns': 64, 'condition_count': {'orderBy': 54, 'groupBy': 184, 'having': 104, 'nested': 100, 'join': 259}}, 'home_improvement': {'avg_tokens': 68.68316831683168, 'num_tables': 17, 'num_columns': 60, 'condition_count': {'orderBy': 2, 'groupBy': 23, 'having': 21, 'nested': 77, 'join': 94}}, 'war_films': {'avg_tokens': 109.1025, 'num_tables': 24, 'num_columns': 121, 'condition_count': {'orderBy': 93, 'groupBy': 131, 'having': 53, 'nested': 8, 'join': 397}}, 'bike_sharing': {'avg_tokens': 46.177570093457945, 'num_tables': 11, 'num_columns': 101, 'condition_count': {'orderBy': 48, 'groupBy': 99, 'having': 28, 'nested': 68, 'join': 41}}, 'blockchain_technology': {'avg_tokens': 72.26627218934911, 'num_tables': 36, 'num_columns': 172, 'condition_count': {'orderBy': 305, 'groupBy': 383, 'having': 96, 'nested': 58, 'join': 460}}, 'martial_arts': {'avg_tokens': 33.43312101910828, 'num_tables': 16, 'num_columns': 65, 'condition_count': {'orderBy': 27, 'groupBy': 38, 'having': 1, 'nested': 10, 'join': 55}}, 'dance': {'avg_tokens': 50.10958904109589, 'num_tables': 42, 'num_columns': 214, 'condition_count': {'orderBy': 22, 'groupBy': 38, 'having': 5, 'nested': 10, 'join': 52}}, 'search_engine_optimization_(seo)': {'avg_tokens': 42.441295546558706, 'num_tables': 27, 'num_columns': 192, 'condition_count': {'orderBy': 75, 'groupBy': 17, 'having': 1, 'nested': 78, 'join': 223}}, 'marketing_books': {'avg_tokens': 80.30412371134021, 'num_tables': 22, 'num_columns': 128, 'condition_count': {'orderBy': 59, 'groupBy': 283, 'having': 113, 'nested': 246, 'join': 350}}, 'risk_management': {'avg_tokens': 51.08510638297872, 'num_tables': 17, 'num_columns': 68, 'condition_count': {'orderBy': 12, 'groupBy': 30, 'having': 0, 'nested': 0, 'join': 43}}, 'journaling': {'avg_tokens': 69.67721518987342, 'num_tables': 22, 'num_columns': 42, 'condition_count': {'orderBy': 10, 'groupBy': 82, 'having': 67, 'nested': 37, 'join': 151}}, 'web_development': {'avg_tokens': 59.66019417475728, 'num_tables': 28, 'num_columns': 56, 'condition_count': {'orderBy': 9, 'groupBy': 61, 'having': 37, 'nested': 27, 'join': 100}}, 'intelligent_public_safety': {'avg_tokens': 92.51626016260163, 'num_tables': 45, 'num_columns': 224, 'condition_count': {'orderBy': 11, 'groupBy': 110, 'having': 4, 'nested': 12, 'join': 219}}, 'meditation': {'avg_tokens': 72.8173076923077, 'num_tables': 17, 'num_columns': 37, 'condition_count': {'orderBy': 15, 'groupBy': 91, 'having': 25, 'nested': 5, 'join': 101}}, 'photography': {'avg_tokens': 51.037837837837834, 'num_tables': 29, 'num_columns': 181, 'condition_count': {'orderBy': 34, 'groupBy': 80, 'having': 32, 'nested': 16, 'join': 154}}, 'web_design': {'avg_tokens': 28.166666666666668, 'num_tables': 4, 'num_columns': 12, 'condition_count': {'orderBy': 1, 'groupBy': 4, 'having': 0, 'nested': 0, 'join': 8}}, 'dance_therapy': {'avg_tokens': 83.78846153846153, 'num_tables': 11, 'num_columns': 37, 'condition_count': {'orderBy': 0, 'groupBy': 12, 'having': 10, 'nested': 7, 'join': 51}}, 'astronomy': {'avg_tokens': 40.705078125, 'num_tables': 20, 'num_columns': 324, 'condition_count': {'orderBy': 14, 'groupBy': 6, 'having': 3, 'nested': 274, 'join': 47}}, 'computer_hardware': {'avg_tokens': 39.079268292682926, 'num_tables': 15, 'num_columns': 35, 'condition_count': {'orderBy': 28, 'groupBy': 87, 'having': 22, 'nested': 23, 'join': 126}}, 'human_resources_management': {'avg_tokens': 91.70652173913044, 'num_tables': 17, 'num_columns': 77, 'condition_count': {'orderBy': 288, 'groupBy': 301, 'having': 15, 'nested': 29, 'join': 339}}, 'surgery': {'avg_tokens': 65.23489932885906, 'num_tables': 16, 'num_columns': 184, 'condition_count': {'orderBy': 79, 'groupBy': 68, 'having': 14, 'nested': 20, 'join': 104}}, 'medicine': {'avg_tokens': 53.857142857142854, 'num_tables': 28, 'num_columns': 105, 'condition_count': {'orderBy': 1, 'groupBy': 3, 'having': 0, 'nested': 0, 'join': 11}}, 'writing_therapy': {'avg_tokens': 95.56831683168316, 'num_tables': 52, 'num_columns': 190, 'condition_count': {'orderBy': 39, 'groupBy': 233, 'having': 136, 'nested': 42, 'join': 486}}, 'data_analysis': {'avg_tokens': 69.18529411764706, 'num_tables': 37, 'num_columns': 230, 'condition_count': {'orderBy': 88, 'groupBy': 245, 'having': 111, 'nested': 64, 'join': 277}}, 'interior_decorating': {'avg_tokens': 50.95652173913044, 'num_tables': 13, 'num_columns': 97, 'condition_count': {'orderBy': 34, 'groupBy': 83, 'having': 31, 'nested': 12, 'join': 199}}, 'internet_of_things_(iot)': {'avg_tokens': 76.71458333333334, 'num_tables': 22, 'num_columns': 119, 'condition_count': {'orderBy': 175, 'groupBy': 164, 'having': 9, 'nested': 19, 'join': 429}}, 'movies': {'avg_tokens': 72.78048780487805, 'num_tables': 12, 'num_columns': 34, 'condition_count': {'orderBy': 8, 'groupBy': 41, 'having': 15, 'nested': 49, 'join': 55}}, 'economics': {'avg_tokens': 50.16858237547893, 'num_tables': 34, 'num_columns': 189, 'condition_count': {'orderBy': 19, 'groupBy': 51, 'having': 14, 'nested': 15, 'join': 211}}, 'basketball': {'avg_tokens': 78.6355748373102, 'num_tables': 32, 'num_columns': 367, 'condition_count': {'orderBy': 132, 'groupBy': 271, 'having': 192, 'nested': 91, 'join': 409}}, 'action_films': {'avg_tokens': 89.02995391705069, 'num_tables': 28, 'num_columns': 88, 'condition_count': {'orderBy': 104, 'groupBy': 225, 'having': 135, 'nested': 218, 'join': 396}}, 'illustration': {'avg_tokens': 78.50737463126843, 'num_tables': 36, 'num_columns': 138, 'condition_count': {'orderBy': 40, 'groupBy': 112, 'having': 43, 'nested': 52, 'join': 289}}, 'ecology': {'avg_tokens': 120.67168674698796, 'num_tables': 24, 'num_columns': 110, 'condition_count': {'orderBy': 5, 'groupBy': 96, 'having': 80, 'nested': 32, 'join': 317}}, 'virtual_event_planning': {'avg_tokens': 36.78072289156626, 'num_tables': 23, 'num_columns': 198, 'condition_count': {'orderBy': 9, 'groupBy': 27, 'having': 4, 'nested': 43, 'join': 60}}, 'acupuncture': {'avg_tokens': 87.00806451612904, 'num_tables': 11, 'num_columns': 54, 'condition_count': {'orderBy': 1, 'groupBy': 68, 'having': 65, 'nested': 43, 'join': 370}}, 'glass_etching': {'avg_tokens': 67.32491582491582, 'num_tables': 28, 'num_columns': 175, 'condition_count': {'orderBy': 254, 'groupBy': 304, 'having': 183, 'nested': 53, 'join': 383}}, 'cloud_computing': {'avg_tokens': 49.02127659574468, 'num_tables': 23, 'num_columns': 66, 'condition_count': {'orderBy': 46, 'groupBy': 109, 'having': 38, 'nested': 24, 'join': 182}}, 'business_strategy': {'avg_tokens': 81.68662674650699, 'num_tables': 45, 'num_columns': 194, 'condition_count': {'orderBy': 325, 'groupBy': 396, 'having': 155, 'nested': 36, 'join': 476}}, 'history': {'avg_tokens': 32.0, 'num_tables': 23, 'num_columns': 69, 'condition_count': {'orderBy': 35, 'groupBy': 0, 'having': 0, 'nested': 1, 'join': 51}}, 'epidemiology': {'avg_tokens': 71.21212121212122, 'num_tables': 17, 'num_columns': 71, 'condition_count': {'orderBy': 14, 'groupBy': 59, 'having': 18, 'nested': 16, 'join': 126}}, 'snowboarding': {'avg_tokens': 70.97410358565737, 'num_tables': 50, 'num_columns': 270, 'condition_count': {'orderBy': 65, 'groupBy': 213, 'having': 10, 'nested': 111, 'join': 298}}, 'content_marketing': {'avg_tokens': 38.111111111111114, 'num_tables': 26, 'num_columns': 155, 'condition_count': {'orderBy': 12, 'groupBy': 22, 'having': 6, 'nested': 3, 'join': 24}}, 'music_therapy': {'avg_tokens': 33.476190476190474, 'num_tables': 70, 'num_columns': 355, 'condition_count': {'orderBy': 17, 'groupBy': 20, 'having': 1, 'nested': 18, 'join': 35}}, 'intelligent_transportation_systems': {'avg_tokens': 74.82116788321167, 'num_tables': 26, 'num_columns': 146, 'condition_count': {'orderBy': 24, 'groupBy': 57, 'having': 6, 'nested': 30, 'join': 188}}, 'oceanography': {'avg_tokens': 25.286516853932586, 'num_tables': 42, 'num_columns': 96, 'condition_count': {'orderBy': 0, 'groupBy': 0, 'having': 0, 'nested': 30, 'join': 0}}, 'public_health': {'avg_tokens': 86.76158940397352, 'num_tables': 49, 'num_columns': 247, 'condition_count': {'orderBy': 62, 'groupBy': 114, 'having': 80, 'nested': 20, 'join': 232}}, 'forensic_science': {'avg_tokens': 64.23880597014926, 'num_tables': 18, 'num_columns': 70, 'condition_count': {'orderBy': 0, 'groupBy': 24, 'having': 23, 'nested': 0, 'join': 133}}, 'sports_officiating': {'avg_tokens': 80.38783269961978, 'num_tables': 42, 'num_columns': 131, 'condition_count': {'orderBy': 121, 'groupBy': 206, 'having': 23, 'nested': 2, 'join': 260}}, 'counseling': {'avg_tokens': 91.67955801104972, 'num_tables': 24, 'num_columns': 160, 'condition_count': {'orderBy': 108, 'groupBy': 240, 'having': 65, 'nested': 28, 'join': 335}}, 'smart_lighting': {'avg_tokens': 113.11538461538461, 'num_tables': 31, 'num_columns': 161, 'condition_count': {'orderBy': 98, 'groupBy': 77, 'having': 12, 'nested': 47, 'join': 139}}, 'yoga_therapy': {'avg_tokens': 49.282051282051285, 'num_tables': 19, 'num_columns': 38, 'condition_count': {'orderBy': 5, 'groupBy': 28, 'having': 15, 'nested': 8, 'join': 70}}, 'pharmacy': {'avg_tokens': 68.40387722132472, 'num_tables': 39, 'num_columns': 241, 'condition_count': {'orderBy': 241, 'groupBy': 286, 'having': 57, 'nested': 204, 'join': 372}}, 'advertising': {'avg_tokens': 83.16448598130842, 'num_tables': 33, 'num_columns': 170, 'condition_count': {'orderBy': 17, 'groupBy': 155, 'having': 3, 'nested': 12, 'join': 479}}, 'graphic_novels': {'avg_tokens': 88.40163934426229, 'num_tables': 40, 'num_columns': 133, 'condition_count': {'orderBy': 15, 'groupBy': 98, 'having': 76, 'nested': 140, 'join': 416}}, 'romance_films': {'avg_tokens': 66.01269035532995, 'num_tables': 26, 'num_columns': 67, 'condition_count': {'orderBy': 42, 'groupBy': 3, 'having': 1, 'nested': 6, 'join': 383}}, 'stand-up_comedy': {'avg_tokens': 78.30058939096267, 'num_tables': 38, 'num_columns': 206, 'condition_count': {'orderBy': 16, 'groupBy': 131, 'having': 32, 'nested': 45, 'join': 464}}, 'geology': {'avg_tokens': 66.46268656716418, 'num_tables': 19, 'num_columns': 83, 'condition_count': {'orderBy': 0, 'groupBy': 16, 'having': 1, 'nested': 6, 'join': 127}}, 'business_development': {'avg_tokens': 39.723214285714285, 'num_tables': 14, 'num_columns': 44, 'condition_count': {'orderBy': 29, 'groupBy': 36, 'having': 10, 'nested': 38, 'join': 62}}, 'comic_books': {'avg_tokens': 103.51351351351352, 'num_tables': 45, 'num_columns': 107, 'condition_count': {'orderBy': 152, 'groupBy': 174, 'having': 44, 'nested': 102, 'join': 400}}, 'drama_films': {'avg_tokens': 57.57377049180328, 'num_tables': 15, 'num_columns': 37, 'condition_count': {'orderBy': 32, 'groupBy': 83, 'having': 39, 'nested': 11, 'join': 118}}, 'information_security': {'avg_tokens': 68.56862745098039, 'num_tables': 21, 'num_columns': 47, 'condition_count': {'orderBy': 7, 'groupBy': 21, 'having': 9, 'nested': 15, 'join': 47}}, 'gardening': {'avg_tokens': 44.51520912547529, 'num_tables': 23, 'num_columns': 219, 'condition_count': {'orderBy': 10, 'groupBy': 18, 'having': 4, 'nested': 27, 'join': 211}}, 'virtual_reality': {'avg_tokens': 122.95846645367412, 'num_tables': 31, 'num_columns': 84, 'condition_count': {'orderBy': 68, 'groupBy': 70, 'having': 12, 'nested': 141, 'join': 246}}, 'craft_beer_brewing': {'avg_tokens': 68.23140495867769, 'num_tables': 23, 'num_columns': 55, 'condition_count': {'orderBy': 6, 'groupBy': 65, 'having': 24, 'nested': 57, 'join': 100}}, 'ui_ux_design': {'avg_tokens': 58.99175824175824, 'num_tables': 21, 'num_columns': 145, 'condition_count': {'orderBy': 42, 'groupBy': 127, 'having': 73, 'nested': 190, 'join': 296}}, 'botany': {'avg_tokens': 99.32, 'num_tables': 56, 'num_columns': 241, 'condition_count': {'orderBy': 11, 'groupBy': 19, 'having': 5, 'nested': 21, 'join': 390}}, 'screenwriting': {'avg_tokens': 31.367346938775512, 'num_tables': 13, 'num_columns': 36, 'condition_count': {'orderBy': 9, 'groupBy': 25, 'having': 14, 'nested': 22, 'join': 42}}, 'sports_medicine': {'avg_tokens': 57.9236641221374, 'num_tables': 33, 'num_columns': 200, 'condition_count': {'orderBy': 41, 'groupBy': 91, 'having': 20, 'nested': 13, 'join': 111}}, 'big_data': {'avg_tokens': 106.31428571428572, 'num_tables': 16, 'num_columns': 121, 'condition_count': {'orderBy': 12, 'groupBy': 220, 'having': 100, 'nested': 244, 'join': 344}}, 'musical_theater': {'avg_tokens': 75.50462107208872, 'num_tables': 39, 'num_columns': 239, 'condition_count': {'orderBy': 398, 'groupBy': 442, 'having': 70, 'nested': 28, 'join': 498}}, 'archaeology': {'avg_tokens': 58.99090909090909, 'num_tables': 28, 'num_columns': 133, 'condition_count': {'orderBy': 1, 'groupBy': 84, 'having': 3, 'nested': 0, 'join': 91}}, 'pilates': {'avg_tokens': 70.96041666666666, 'num_tables': 40, 'num_columns': 239, 'condition_count': {'orderBy': 149, 'groupBy': 334, 'having': 128, 'nested': 89, 'join': 413}}, 'data_mining': {'avg_tokens': 39.613995485327315, 'num_tables': 38, 'num_columns': 206, 'condition_count': {'orderBy': 52, 'groupBy': 177, 'having': 38, 'nested': 87, 'join': 223}}, 'marine_biology': {'avg_tokens': 43.89165186500888, 'num_tables': 30, 'num_columns': 216, 'condition_count': {'orderBy': 26, 'groupBy': 124, 'having': 3, 'nested': 14, 'join': 219}}, 'cosmetics_making': {'avg_tokens': 60.473794549266245, 'num_tables': 26, 'num_columns': 180, 'condition_count': {'orderBy': 129, 'groupBy': 242, 'having': 100, 'nested': 107, 'join': 412}}, 'mobile_app_design': {'avg_tokens': 80.5, 'num_tables': 18, 'num_columns': 34, 'condition_count': {'orderBy': 5, 'groupBy': 66, 'having': 50, 'nested': 53, 'join': 102}}, 'game_design': {'avg_tokens': 71.42736842105263, 'num_tables': 24, 'num_columns': 88, 'condition_count': {'orderBy': 7, 'groupBy': 57, 'having': 51, 'nested': 4, 'join': 355}}, 'high-speed_trains': {'avg_tokens': 47.72115384615385, 'num_tables': 29, 'num_columns': 281, 'condition_count': {'orderBy': 14, 'groupBy': 23, 'having': 4, 'nested': 9, 'join': 33}}, 'cardiovascular_training': {'avg_tokens': 31.133333333333333, 'num_tables': 15, 'num_columns': 38, 'condition_count': {'orderBy': 0, 'groupBy': 0, 'having': 0, 'nested': 29, 'join': 15}}, 'documentary_films': {'avg_tokens': 86.6829268292683, 'num_tables': 43, 'num_columns': 182, 'condition_count': {'orderBy': 9, 'groupBy': 15, 'having': 3, 'nested': 5, 'join': 403}}, 'business': {'avg_tokens': 81.501953125, 'num_tables': 36, 'num_columns': 226, 'condition_count': {'orderBy': 375, 'groupBy': 396, 'having': 95, 'nested': 32, 'join': 443}}, 'entomology': {'avg_tokens': 93.86190476190477, 'num_tables': 23, 'num_columns': 131, 'condition_count': {'orderBy': 62, 'groupBy': 74, 'having': 19, 'nested': 2, 'join': 192}}, 'data_analytics': {'avg_tokens': 70.15189873417721, 'num_tables': 27, 'num_columns': 62, 'condition_count': {'orderBy': 28, 'groupBy': 194, 'having': 68, 'nested': 8, 'join': 237}}, 'agriculture': {'avg_tokens': 59.526881720430104, 'num_tables': 13, 'num_columns': 67, 'condition_count': {'orderBy': 30, 'groupBy': 110, 'having': 55, 'nested': 73, 'join': 131}}, 'soapstone_carving': {'avg_tokens': 70.12338858195211, 'num_tables': 26, 'num_columns': 153, 'condition_count': {'orderBy': 326, 'groupBy': 405, 'having': 67, 'nested': 41, 'join': 443}}, 'boxing': {'avg_tokens': 83.93333333333334, 'num_tables': 17, 'num_columns': 71, 'condition_count': {'orderBy': 1, 'groupBy': 91, 'having': 35, 'nested': 31, 'join': 118}}, 'leadership': {'avg_tokens': 78.41233766233766, 'num_tables': 42, 'num_columns': 232, 'condition_count': {'orderBy': 78, 'groupBy': 100, 'having': 8, 'nested': 18, 'join': 249}}, 'sustainability': {'avg_tokens': 95.42560553633218, 'num_tables': 27, 'num_columns': 144, 'condition_count': {'orderBy': 210, 'groupBy': 234, 'having': 63, 'nested': 55, 'join': 272}}, 'athletic_training': {'avg_tokens': 94.0730593607306, 'num_tables': 47, 'num_columns': 300, 'condition_count': {'orderBy': 68, 'groupBy': 298, 'having': 183, 'nested': 194, 'join': 388}}, 'interior_design': {'avg_tokens': 56.31404958677686, 'num_tables': 22, 'num_columns': 54, 'condition_count': {'orderBy': 78, 'groupBy': 82, 'having': 60, 'nested': 28, 'join': 105}}, 'talk_shows': {'avg_tokens': 81.28070175438596, 'num_tables': 12, 'num_columns': 51, 'condition_count': {'orderBy': 68, 'groupBy': 111, 'having': 66, 'nested': 88, 'join': 166}}, 'volleyball': {'avg_tokens': 140.7431693989071, 'num_tables': 23, 'num_columns': 61, 'condition_count': {'orderBy': 2, 'groupBy': 527, 'having': 518, 'nested': 24, 'join': 547}}, 'makeup_artistry': {'avg_tokens': 63.06060606060606, 'num_tables': 36, 'num_columns': 236, 'condition_count': {'orderBy': 86, 'groupBy': 135, 'having': 28, 'nested': 24, 'join': 162}}, 'coaching': {'avg_tokens': 40.443697478991595, 'num_tables': 24, 'num_columns': 159, 'condition_count': {'orderBy': 43, 'groupBy': 83, 'having': 17, 'nested': 34, 'join': 277}}, 'tv_shows': {'avg_tokens': 98.33707865168539, 'num_tables': 63, 'num_columns': 245, 'condition_count': {'orderBy': 10, 'groupBy': 144, 'having': 133, 'nested': 206, 'join': 301}}, 'augmented_reality': {'avg_tokens': 45.3421052631579, 'num_tables': 46, 'num_columns': 238, 'condition_count': {'orderBy': 32, 'groupBy': 64, 'having': 6, 'nested': 15, 'join': 56}}, 'anthropology': {'avg_tokens': 66.04255319148936, 'num_tables': 19, 'num_columns': 62, 'condition_count': {'orderBy': 15, 'groupBy': 43, 'having': 21, 'nested': 0, 'join': 127}}, 'business_books': {'avg_tokens': 84.71030042918454, 'num_tables': 35, 'num_columns': 166, 'condition_count': {'orderBy': 295, 'groupBy': 365, 'having': 25, 'nested': 25, 'join': 405}}, 'horror_films': {'avg_tokens': 97.93159609120521, 'num_tables': 56, 'num_columns': 201, 'condition_count': {'orderBy': 240, 'groupBy': 207, 'having': 59, 'nested': 12, 'join': 234}}, 'electronic_music': {'avg_tokens': 77.93483709273183, 'num_tables': 33, 'num_columns': 72, 'condition_count': {'orderBy': 112, 'groupBy': 322, 'having': 233, 'nested': 97, 'join': 394}}, 'sociology': {'avg_tokens': 92.0304347826087, 'num_tables': 28, 'num_columns': 76, 'condition_count': {'orderBy': 4, 'groupBy': 182, 'having': 98, 'nested': 120, 'join': 210}}, 'psychology_books': {'avg_tokens': 86.65876777251185, 'num_tables': 16, 'num_columns': 105, 'condition_count': {'orderBy': 205, 'groupBy': 252, 'having': 104, 'nested': 110, 'join': 392}}, 'energy_management': {'avg_tokens': 37.725806451612904, 'num_tables': 10, 'num_columns': 42, 'condition_count': {'orderBy': 22, 'groupBy': 23, 'having': 1, 'nested': 2, 'join': 0}}, 'news_programs': {'avg_tokens': 97.97849462365592, 'num_tables': 32, 'num_columns': 81, 'condition_count': {'orderBy': 25, 'groupBy': 89, 'having': 57, 'nested': 203, 'join': 246}}, 'country_music': {'avg_tokens': 60.895890410958906, 'num_tables': 31, 'num_columns': 59, 'condition_count': {'orderBy': 202, 'groupBy': 160, 'having': 67, 'nested': 46, 'join': 351}}, 'chiropractic': {'avg_tokens': 103.82035928143712, 'num_tables': 17, 'num_columns': 60, 'condition_count': {'orderBy': 0, 'groupBy': 0, 'having': 0, 'nested': 0, 'join': 166}}, 'developmental_psychology': {'avg_tokens': 90.43450479233226, 'num_tables': 22, 'num_columns': 77, 'condition_count': {'orderBy': 62, 'groupBy': 103, 'having': 19, 'nested': 106, 'join': 300}}, 'political_science': {'avg_tokens': 38.54703832752613, 'num_tables': 29, 'num_columns': 165, 'condition_count': {'orderBy': 125, 'groupBy': 77, 'having': 17, 'nested': 110, 'join': 71}}, 'sports_psychology': {'avg_tokens': 100.74709976798144, 'num_tables': 26, 'num_columns': 158, 'condition_count': {'orderBy': 128, 'groupBy': 116, 'having': 8, 'nested': 36, 'join': 360}}, 'tai_chi': {'avg_tokens': 85.71348314606742, 'num_tables': 13, 'num_columns': 57, 'condition_count': {'orderBy': 1, 'groupBy': 31, 'having': 24, 'nested': 51, 'join': 173}}, 'energy': {'avg_tokens': 50.63522012578616, 'num_tables': 19, 'num_columns': 120, 'condition_count': {'orderBy': 5, 'groupBy': 133, 'having': 0, 'nested': 30, 'join': 141}}, 'fitness_instruction': {'avg_tokens': 38.02325581395349, 'num_tables': 30, 'num_columns': 242, 'condition_count': {'orderBy': 14, 'groupBy': 26, 'having': 2, 'nested': 0, 'join': 31}}, 'corporate_social_responsibility': {'avg_tokens': 76.6875, 'num_tables': 13, 'num_columns': 64, 'condition_count': {'orderBy': 1, 'groupBy': 131, 'having': 3, 'nested': 12, 'join': 177}}, 'genetics': {'avg_tokens': 64.12253829321664, 'num_tables': 43, 'num_columns': 207, 'condition_count': {'orderBy': 3, 'groupBy': 8, 'having': 6, 'nested': 11, 'join': 421}}}
          ### Desired output format:
          law &
          78 &
          30 &
          235 &
          523 &
          81 &
          239 &
          94 &
          37 &
          484 \\
          ...
          ### help me continue the organization of the rest data
'''

# result = GPT4_generation(message)
# print(result)

import json

data = '''
{'law': {'avg_tokens': 78.0057361376673, 'num_tables': 30, 'num_columns': 235, 'sql_count': 523, 'condition_count': {'orderBy': 81, 'groupBy': 239, 'having': 94, 'nested': 37, 'join': 484}}, 'thriller_novels': {'avg_tokens': 78.9419795221843, 'num_tables': 19, 'num_columns': 78, 'sql_count': 293, 'condition_count': {'orderBy': 35, 'groupBy': 139, 'having': 108, 'nested': 18, 'join': 288}}, 'fitness': {'avg_tokens': 73.64882943143813, 'num_tables': 22, 'num_columns': 127, 'sql_count': 299, 'condition_count': {'orderBy': 66, 'groupBy': 225, 'having': 4, 'nested': 81, 'join': 279}}, 'copywriting': {'avg_tokens': 51.48913043478261, 'num_tables': 12, 'num_columns': 45, 'sql_count': 92, 'condition_count': {'orderBy': 16, 'groupBy': 70, 'having': 30, 'nested': 2, 'join': 91}}, 'public_relations': {'avg_tokens': 63.68518518518518, 'num_tables': 44, 'num_columns': 240, 'sql_count': 486, 'condition_count': {'orderBy': 7, 'groupBy': 14, 'having': 8, 'nested': 17, 'join': 461}}, 'music': {'avg_tokens': 81.69047619047619, 'num_tables': 11, 'num_columns': 43, 'sql_count': 252, 'condition_count': {'orderBy': 34, 'groupBy': 224, 'having': 150, 'nested': 146, 'join': 250}}, 'project_management': {'avg_tokens': 61.624605678233436, 'num_tables': 26, 'num_columns': 181, 'sql_count': 634, 'condition_count': {'orderBy': 46, 'groupBy': 220, 'having': 13, 'nested': 62, 'join': 544}}, 'psychotherapy': {'avg_tokens': 91.22185430463576, 'num_tables': 9, 'num_columns': 66, 'sql_count': 302, 'condition_count': {'orderBy': 82, 'groupBy': 166, 'having': 51, 'nested': 48, 'join': 293}}, 'nursing': {'avg_tokens': 79.61953727506426, 'num_tables': 35, 'num_columns': 180, 'sql_count': 389, 'condition_count': {'orderBy': 30, 'groupBy': 57, 'having': 18, 'nested': 53, 'join': 363}}, 'philosophy': {'avg_tokens': 114.70414201183432, 'num_tables': 12, 'num_columns': 51, 'sql_count': 169, 'condition_count': {'orderBy': 0, 'groupBy': 14, 'having': 14, 'nested': 22, 'join': 166}}, 'education': {'avg_tokens': 66.6, 'num_tables': 26, 'num_columns': 68, 'sql_count': 185, 'condition_count': {'orderBy': 18, 'groupBy': 144, 'having': 89, 'nested': 72, 'join': 178}}, 'event_management': {'avg_tokens': 89.98163265306123, 'num_tables': 44, 'num_columns': 235, 'sql_count': 490, 'condition_count': {'orderBy': 187, 'groupBy': 345, 'having': 34, 'nested': 41, 'join': 434}}, 'personal_training': {'avg_tokens': 89.56218905472637, 'num_tables': 73, 'num_columns': 339, 'sql_count': 402, 'condition_count': {'orderBy': 46, 'groupBy': 179, 'having': 95, 'nested': 20, 'join': 357}}, 'finance': {'avg_tokens': 26.474537037037038, 'num_tables': 34, 'num_columns': 306, 'sql_count': 432, 'condition_count': {'orderBy': 7, 'groupBy': 25, 'having': 2, 'nested': 20, 'join': 31}}, 'painting': {'avg_tokens': 98.07296137339056, 'num_tables': 23, 'num_columns': 133, 'sql_count': 466, 'condition_count': {'orderBy': 5, 'groupBy': 9, 'having': 5, 'nested': 110, 'join': 461}}, 'comedy_films': {'avg_tokens': 103.91037735849056, 'num_tables': 22, 'num_columns': 38, 'sql_count': 212, 'condition_count': {'orderBy': 5, 'groupBy': 180, 'having': 164, 'nested': 209, 'join': 185}}, 'food_and_drink_books': {'avg_tokens': 79.81553398058253, 'num_tables': 23, 'num_columns': 33, 'sql_count': 103, 'condition_count': {'orderBy': 2, 'groupBy': 22, 'having': 17, 'nested': 16, 'join': 101}}, 'western_films': {'avg_tokens': 84.76744186046511, 'num_tables': 34, 'num_columns': 100, 'sql_count': 129, 'condition_count': {'orderBy': 60, 'groupBy': 56, 'having': 14, 'nested': 12, 'join': 113}}, 'forensic_psychology': {'avg_tokens': 76.35258358662614, 'num_tables': 49, 'num_columns': 255, 'sql_count': 329, 'condition_count': {'orderBy': 16, 'groupBy': 61, 'having': 10, 'nested': 71, 'join': 263}}, 'shipping_and_logistics': {'avg_tokens': 59.16417910447761, 'num_tables': 19, 'num_columns': 58, 'sql_count': 134, 'condition_count': {'orderBy': 11, 'groupBy': 60, 'having': 13, 'nested': 71, 'join': 86}}, 'science_fiction_films': {'avg_tokens': 68.64588528678304, 'num_tables': 26, 'num_columns': 56, 'sql_count': 401, 'condition_count': {'orderBy': 100, 'groupBy': 245, 'having': 124, 'nested': 139, 'join': 357}}, 'mobile_app_development': {'avg_tokens': 41.57575757575758, 'num_tables': 18, 'num_columns': 133, 'sql_count': 528, 'condition_count': {'orderBy': 15, 'groupBy': 17, 'having': 4, 'nested': 80, 'join': 311}}, 'travel': {'avg_tokens': 67.49659863945578, 'num_tables': 42, 'num_columns': 230, 'sql_count': 147, 'condition_count': {'orderBy': 46, 'groupBy': 55, 'having': 3, 'nested': 3, 'join': 134}}, 'business_intelligence': {'avg_tokens': 62.399253731343286, 'num_tables': 30, 'num_columns': 253, 'sql_count': 536, 'condition_count': {'orderBy': 14, 'groupBy': 130, 'having': 66, 'nested': 37, 'join': 464}}, 'accounting': {'avg_tokens': 42.649289099526065, 'num_tables': 41, 'num_columns': 246, 'sql_count': 422, 'condition_count': {'orderBy': 144, 'groupBy': 136, 'having': 14, 'nested': 19, 'join': 237}}, 'fictional_art': {'avg_tokens': 45.570754716981135, 'num_tables': 27, 'num_columns': 182, 'sql_count': 212, 'condition_count': {'orderBy': 14, 'groupBy': 45, 'having': 18, 'nested': 40, 'join': 147}}, 'user_experience_(ux)_design': {'avg_tokens': 44.04448742746615, 'num_tables': 26, 'num_columns': 176, 'sql_count': 517, 'condition_count': {'orderBy': 4, 'groupBy': 159, 'having': 19, 'nested': 130, 'join': 240}}, 'health_and_wellness_programs': {'avg_tokens': 92.60196078431373, 'num_tables': 35, 'num_columns': 153, 'sql_count': 510, 'condition_count': {'orderBy': 198, 'groupBy': 336, 'having': 108, 'nested': 35, 'join': 448}}, 'industrial_design': {'avg_tokens': 31.670212765957448, 'num_tables': 22, 'num_columns': 119, 'sql_count': 94, 'condition_count': {'orderBy': 14, 'groupBy': 22, 'having': 4, 'nested': 26, 'join': 34}}, 'network_security': {'avg_tokens': 79.57603686635944, 'num_tables': 18, 'num_columns': 169, 'sql_count': 217, 'condition_count': {'orderBy': 79, 'groupBy': 1, 'having': 1, 'nested': 0, 'join': 189}}, 'user_interface_design': {'avg_tokens': 55.40972222222222, 'num_tables': 21, 'num_columns': 137, 'sql_count': 576, 'condition_count': {'orderBy': 39, 'groupBy': 187, 'having': 63, 'nested': 167, 'join': 228}}, 'cooking_shows': {'avg_tokens': 48.329787234042556, 'num_tables': 24, 'num_columns': 49, 'sql_count': 188, 'condition_count': {'orderBy': 5, 'groupBy': 90, 'having': 72, 'nested': 35, 'join': 145}}, 'hypnotherapy': {'avg_tokens': 72.82211538461539, 'num_tables': 26, 'num_columns': 166, 'sql_count': 416, 'condition_count': {'orderBy': 163, 'groupBy': 227, 'having': 41, 'nested': 34, 'join': 349}}, 'operations_management': {'avg_tokens': 63.74, 'num_tables': 51, 'num_columns': 329, 'sql_count': 550, 'condition_count': {'orderBy': 119, 'groupBy': 207, 'having': 57, 'nested': 27, 'join': 505}}, 'cybersecurity': {'avg_tokens': 65.7202380952381, 'num_tables': 51, 'num_columns': 260, 'sql_count': 336, 'condition_count': {'orderBy': 35, 'groupBy': 25, 'having': 14, 'nested': 4, 'join': 277}}, 'cooking': {'avg_tokens': 62.67479674796748, 'num_tables': 16, 'num_columns': 53, 'sql_count': 123, 'condition_count': {'orderBy': 11, 'groupBy': 80, 'having': 63, 'nested': 32, 'join': 118}}, 'homeopathy': {'avg_tokens': 62.77325581395349, 'num_tables': 10, 'num_columns': 43, 'sql_count': 172, 'condition_count': {'orderBy': 0, 'groupBy': 1, 'having': 0, 'nested': 13, 'join': 105}}, 'civil_engineering': {'avg_tokens': 71.6875, 'num_tables': 44, 'num_columns': 233, 'sql_count': 560, 'condition_count': {'orderBy': 16, 'groupBy': 103, 'having': 35, 'nested': 54, 'join': 509}}, 'game_shows': {'avg_tokens': 111.21985815602837, 'num_tables': 22, 'num_columns': 75, 'sql_count': 141, 'condition_count': {'orderBy': 2, 'groupBy': 131, 'having': 113, 'nested': 74, 'join': 140}}, 'jazz': {'avg_tokens': 80.78853046594982, 'num_tables': 28, 'num_columns': 49, 'sql_count': 279, 'condition_count': {'orderBy': 0, 'groupBy': 95, 'having': 95, 'nested': 277, 'join': 0}}, 'sculpting': {'avg_tokens': 94.89001692047377, 'num_tables': 28, 'num_columns': 63, 'sql_count': 591, 'condition_count': {'orderBy': 10, 'groupBy': 69, 'having': 52, 'nested': 146, 'join': 584}}, 'computer_engineering': {'avg_tokens': 57.48913043478261, 'num_tables': 22, 'num_columns': 59, 'sql_count': 92, 'condition_count': {'orderBy': 7, 'groupBy': 64, 'having': 52, 'nested': 61, 'join': 62}}, 'email_marketing': {'avg_tokens': 79.49731182795699, 'num_tables': 19, 'num_columns': 116, 'sql_count': 372, 'condition_count': {'orderBy': 61, 'groupBy': 116, 'having': 6, 'nested': 90, 'join': 261}}, 'retail': {'avg_tokens': 59.81981981981982, 'num_tables': 28, 'num_columns': 57, 'sql_count': 111, 'condition_count': {'orderBy': 12, 'groupBy': 93, 'having': 47, 'nested': 24, 'join': 103}}, 'triathlon': {'avg_tokens': 54.492063492063494, 'num_tables': 10, 'num_columns': 42, 'sql_count': 63, 'condition_count': {'orderBy': 26, 'groupBy': 45, 'having': 11, 'nested': 3, 'join': 59}}, 'industrial_engineering': {'avg_tokens': 70.21212121212122, 'num_tables': 18, 'num_columns': 65, 'sql_count': 66, 'condition_count': {'orderBy': 44, 'groupBy': 43, 'having': 33, 'nested': 22, 'join': 48}}, 'food_and_drink': {'avg_tokens': 50.36065573770492, 'num_tables': 37, 'num_columns': 221, 'sql_count': 488, 'condition_count': {'orderBy': 127, 'groupBy': 77, 'having': 9, 'nested': 216, 'join': 212}}, 'cognitive_psychology': {'avg_tokens': 88.24096385542168, 'num_tables': 20, 'num_columns': 53, 'sql_count': 83, 'condition_count': {'orderBy': 29, 'groupBy': 82, 'having': 38, 'nested': 4, 'join': 82}}, 'smart_transportation': {'avg_tokens': 43.25833333333333, 'num_tables': 15, 'num_columns': 43, 'sql_count': 120, 'condition_count': {'orderBy': 23, 'groupBy': 90, 'having': 12, 'nested': 7, 'join': 110}}, 'environment': {'avg_tokens': 75.4055944055944, 'num_tables': 42, 'num_columns': 231, 'sql_count': 286, 'condition_count': {'orderBy': 178, 'groupBy': 45, 'having': 0, 'nested': 0, 'join': 279}}, 'technology': {'avg_tokens': 70.96703296703296, 'num_tables': 15, 'num_columns': 64, 'sql_count': 273, 'condition_count': {'orderBy': 54, 'groupBy': 184, 'having': 104, 'nested': 100, 'join': 259}}, 'home_improvement': {'avg_tokens': 68.68316831683168, 'num_tables': 17, 'num_columns': 60, 'sql_count': 101, 'condition_count': {'orderBy': 2, 'groupBy': 23, 'having': 21, 'nested': 77, 'join': 94}}, 'war_films': {'avg_tokens': 109.1025, 'num_tables': 24, 'num_columns': 121, 'sql_count': 400, 'condition_count': {'orderBy': 93, 'groupBy': 131, 'having': 53, 'nested': 8, 'join': 397}}, 'bike_sharing': {'avg_tokens': 46.177570093457945, 'num_tables': 11, 'num_columns': 101, 'sql_count': 214, 'condition_count': {'orderBy': 48, 'groupBy': 99, 'having': 28, 'nested': 68, 'join': 41}}, 'blockchain_technology': {'avg_tokens': 72.26627218934911, 'num_tables': 36, 'num_columns': 172, 'sql_count': 507, 'condition_count': {'orderBy': 305, 'groupBy': 383, 'having': 96, 'nested': 58, 'join': 460}}, 'martial_arts': {'avg_tokens': 33.43312101910828, 'num_tables': 16, 'num_columns': 65, 'sql_count': 157, 'condition_count': {'orderBy': 27, 'groupBy': 38, 'having': 1, 'nested': 10, 'join': 55}}, 'dance': {'avg_tokens': 50.10958904109589, 'num_tables': 42, 'num_columns': 214, 'sql_count': 73, 'condition_count': {'orderBy': 22, 'groupBy': 38, 'having': 5, 'nested': 10, 'join': 52}}, 'search_engine_optimization_(seo)': {'avg_tokens': 42.441295546558706, 'num_tables': 27, 'num_columns': 192, 'sql_count': 494, 'condition_count': {'orderBy': 75, 'groupBy': 17, 'having': 1, 'nested': 78, 'join': 223}}, 'marketing_books': {'avg_tokens': 80.30412371134021, 'num_tables': 22, 'num_columns': 128, 'sql_count': 388, 'condition_count': {'orderBy': 59, 'groupBy': 283, 'having': 113, 'nested': 246, 'join': 350}}, 'risk_management': {'avg_tokens': 51.08510638297872, 'num_tables': 17, 'num_columns': 68, 'sql_count': 47, 'condition_count': {'orderBy': 12, 'groupBy': 30, 'having': 0, 'nested': 0, 'join': 43}}, 'journaling': {'avg_tokens': 69.67721518987342, 'num_tables': 22, 'num_columns': 42, 'sql_count': 158, 'condition_count': {'orderBy': 10, 'groupBy': 82, 'having': 67, 'nested': 37, 'join': 151}}, 'web_development': {'avg_tokens': 59.66019417475728, 'num_tables': 28, 'num_columns': 56, 'sql_count': 103, 'condition_count': {'orderBy': 9, 'groupBy': 61, 'having': 37, 'nested': 27, 'join': 100}}, 'intelligent_public_safety': {'avg_tokens': 92.51626016260163, 'num_tables': 45, 'num_columns': 224, 'sql_count': 246, 'condition_count': {'orderBy': 11, 'groupBy': 110, 'having': 4, 'nested': 12, 'join': 219}}, 'meditation': {'avg_tokens': 72.8173076923077, 'num_tables': 17, 'num_columns': 37, 'sql_count': 104, 'condition_count': {'orderBy': 15, 'groupBy': 91, 'having': 25, 'nested': 5, 'join': 101}}, 'photography': {'avg_tokens': 51.037837837837834, 'num_tables': 29, 'num_columns': 181, 'sql_count': 185, 'condition_count': {'orderBy': 34, 'groupBy': 80, 'having': 32, 'nested': 16, 'join': 154}}, 'web_design': {'avg_tokens': 28.166666666666668, 'num_tables': 4, 'num_columns': 12, 'sql_count': 18, 'condition_count': {'orderBy': 1, 'groupBy': 4, 'having': 0, 'nested': 0, 'join': 8}}, 'dance_therapy': {'avg_tokens': 83.78846153846153, 'num_tables': 11, 'num_columns': 37, 'sql_count': 52, 'condition_count': {'orderBy': 0, 'groupBy': 12, 'having': 10, 'nested': 7, 'join': 51}}, 'astronomy': {'avg_tokens': 40.705078125, 'num_tables': 20, 'num_columns': 324, 'sql_count': 512, 'condition_count': {'orderBy': 14, 'groupBy': 6, 'having': 3, 'nested': 274, 'join': 47}}, 'computer_hardware': {'avg_tokens': 39.079268292682926, 'num_tables': 15, 'num_columns': 35, 'sql_count': 164, 'condition_count': {'orderBy': 28, 'groupBy': 87, 'having': 22, 'nested': 23, 'join': 126}}, 'human_resources_management': {'avg_tokens': 91.70652173913044, 'num_tables': 17, 'num_columns': 77, 'sql_count': 368, 'condition_count': {'orderBy': 288, 'groupBy': 301, 'having': 15, 'nested': 29, 'join': 339}}, 'surgery': {'avg_tokens': 65.23489932885906, 'num_tables': 16, 'num_columns': 184, 'sql_count': 149, 'condition_count': {'orderBy': 79, 'groupBy': 68, 'having': 14, 'nested': 20, 'join': 104}}, 'medicine': {'avg_tokens': 53.857142857142854, 'num_tables': 28, 'num_columns': 105, 'sql_count': 14, 'condition_count': {'orderBy': 1, 'groupBy': 3, 'having': 0, 'nested': 0, 'join': 11}}, 'writing_therapy': {'avg_tokens': 95.56831683168316, 'num_tables': 52, 'num_columns': 190, 'sql_count': 505, 'condition_count': {'orderBy': 39, 'groupBy': 233, 'having': 136, 'nested': 42, 'join': 486}}, 'data_analysis': {'avg_tokens': 69.18529411764706, 'num_tables': 37, 'num_columns': 230, 'sql_count': 340, 'condition_count': {'orderBy': 88, 'groupBy': 245, 'having': 111, 'nested': 64, 'join': 277}}, 'interior_decorating': {'avg_tokens': 50.95652173913044, 'num_tables': 13, 'num_columns': 97, 'sql_count': 230, 'condition_count': {'orderBy': 34, 'groupBy': 83, 'having': 31, 'nested': 12, 'join': 199}}, 'internet_of_things_(iot)': {'avg_tokens': 76.71458333333334, 'num_tables': 22, 'num_columns': 119, 'sql_count': 480, 'condition_count': {'orderBy': 175, 'groupBy': 164, 'having': 9, 'nested': 19, 'join': 429}}, 'movies': {'avg_tokens': 72.78048780487805, 'num_tables': 12, 'num_columns': 34, 'sql_count': 82, 'condition_count': {'orderBy': 8, 'groupBy': 41, 'having': 15, 'nested': 49, 'join': 55}}, 'economics': {'avg_tokens': 50.16858237547893, 'num_tables': 34, 'num_columns': 189, 'sql_count': 261, 'condition_count': {'orderBy': 19, 'groupBy': 51, 'having': 14, 'nested': 15, 'join': 211}}, 'basketball': {'avg_tokens': 78.6355748373102, 'num_tables': 32, 'num_columns': 367, 'sql_count': 461, 'condition_count': {'orderBy': 132, 'groupBy': 271, 'having': 192, 'nested': 91, 'join': 409}}, 'action_films': {'avg_tokens': 89.02995391705069, 'num_tables': 28, 'num_columns': 88, 'sql_count': 434, 'condition_count': {'orderBy': 104, 'groupBy': 225, 'having': 135, 'nested': 218, 'join': 396}}, 'illustration': {'avg_tokens': 78.50737463126843, 'num_tables': 36, 'num_columns': 138, 'sql_count': 339, 'condition_count': {'orderBy': 40, 'groupBy': 112, 'having': 43, 'nested': 52, 'join': 289}}, 'ecology': {'avg_tokens': 120.67168674698796, 'num_tables': 24, 'num_columns': 110, 'sql_count': 332, 'condition_count': {'orderBy': 5, 'groupBy': 96, 'having': 80, 'nested': 32, 'join': 317}}, 'virtual_event_planning': {'avg_tokens': 36.78072289156626, 'num_tables': 23, 'num_columns': 198, 'sql_count': 415, 'condition_count': {'orderBy': 9, 'groupBy': 27, 'having': 4, 'nested': 43, 'join': 60}}, 'acupuncture': {'avg_tokens': 87.00806451612904, 'num_tables': 11, 'num_columns': 54, 'sql_count': 372, 'condition_count': {'orderBy': 1, 'groupBy': 68, 'having': 65, 'nested': 43, 'join': 370}}, 'glass_etching': {'avg_tokens': 67.32491582491582, 'num_tables': 28, 'num_columns': 175, 'sql_count': 594, 'condition_count': {'orderBy': 254, 'groupBy': 304, 'having': 183, 'nested': 53, 'join': 383}}, 'cloud_computing': {'avg_tokens': 49.02127659574468, 'num_tables': 23, 'num_columns': 66, 'sql_count': 188, 'condition_count': {'orderBy': 46, 'groupBy': 109, 'having': 38, 'nested': 24, 'join': 182}}, 'business_strategy': {'avg_tokens': 81.68662674650699, 'num_tables': 45, 'num_columns': 194, 'sql_count': 501, 'condition_count': {'orderBy': 325, 'groupBy': 396, 'having': 155, 'nested': 36, 'join': 476}}, 'history': {'avg_tokens': 32.0, 'num_tables': 23, 'num_columns': 69, 'sql_count': 102, 'condition_count': {'orderBy': 35, 'groupBy': 0, 'having': 0, 'nested': 1, 'join': 51}}, 'epidemiology': {'avg_tokens': 71.21212121212122, 'num_tables': 17, 'num_columns': 71, 'sql_count': 132, 'condition_count': {'orderBy': 14, 'groupBy': 59, 'having': 18, 'nested': 16, 'join': 126}}, 'snowboarding': {'avg_tokens': 70.97410358565737, 'num_tables': 50, 'num_columns': 270, 'sql_count': 502, 'condition_count': {'orderBy': 65, 'groupBy': 213, 'having': 10, 'nested': 111, 'join': 298}}, 'content_marketing': {'avg_tokens': 38.111111111111114, 'num_tables': 26, 'num_columns': 155, 'sql_count': 54, 'condition_count': {'orderBy': 12, 'groupBy': 22, 'having': 6, 'nested': 3, 'join': 24}}, 'music_therapy': {'avg_tokens': 33.476190476190474, 'num_tables': 70, 'num_columns': 355, 'sql_count': 84, 'condition_count': {'orderBy': 17, 'groupBy': 20, 'having': 1, 'nested': 18, 'join': 35}}, 'intelligent_transportation_systems': {'avg_tokens': 74.82116788321167, 'num_tables': 26, 'num_columns': 146, 'sql_count': 274, 'condition_count': {'orderBy': 24, 'groupBy': 57, 'having': 6, 'nested': 30, 'join': 188}}, 'oceanography': {'avg_tokens': 25.286516853932586, 'num_tables': 42, 'num_columns': 96, 'sql_count': 178, 'condition_count': {'orderBy': 0, 'groupBy': 0, 'having': 0, 'nested': 30, 'join': 0}}, 'public_health': {'avg_tokens': 86.76158940397352, 'num_tables': 49, 'num_columns': 247, 'sql_count': 302, 'condition_count': {'orderBy': 62, 'groupBy': 114, 'having': 80, 'nested': 20, 'join': 232}}, 'forensic_science': {'avg_tokens': 64.23880597014926, 'num_tables': 18, 'num_columns': 70, 'sql_count': 134, 'condition_count': {'orderBy': 0, 'groupBy': 24, 'having': 23, 'nested': 0, 'join': 133}}, 'sports_officiating': {'avg_tokens': 80.38783269961978, 'num_tables': 42, 'num_columns': 131, 'sql_count': 263, 'condition_count': {'orderBy': 121, 'groupBy': 206, 'having': 23, 'nested': 2, 'join': 260}}, 'counseling': {'avg_tokens': 91.67955801104972, 'num_tables': 24, 'num_columns': 160, 'sql_count': 362, 'condition_count': {'orderBy': 108, 'groupBy': 240, 'having': 65, 'nested': 28, 'join': 335}}, 'smart_lighting': {'avg_tokens': 113.11538461538461, 'num_tables': 31, 'num_columns': 161, 'sql_count': 156, 'condition_count': {'orderBy': 98, 'groupBy': 77, 'having': 12, 'nested': 47, 'join': 139}}, 'yoga_therapy': {'avg_tokens': 49.282051282051285, 'num_tables': 19, 'num_columns': 38, 'sql_count': 78, 'condition_count': {'orderBy': 5, 'groupBy': 28, 'having': 15, 'nested': 8, 'join': 70}}, 'pharmacy': {'avg_tokens': 68.40387722132472, 'num_tables': 39, 'num_columns': 241, 'sql_count': 619, 'condition_count': {'orderBy': 241, 'groupBy': 286, 'having': 57, 'nested': 204, 'join': 372}}, 'advertising': {'avg_tokens': 83.16448598130842, 'num_tables': 33, 'num_columns': 170, 'sql_count': 535, 'condition_count': {'orderBy': 17, 'groupBy': 155, 'having': 3, 'nested': 12, 'join': 479}}, 'graphic_novels': {'avg_tokens': 88.40163934426229, 'num_tables': 40, 'num_columns': 133, 'sql_count': 488, 'condition_count': {'orderBy': 15, 'groupBy': 98, 'having': 76, 'nested': 140, 'join': 416}}, 'romance_films': {'avg_tokens': 66.01269035532995, 'num_tables': 26, 'num_columns': 67, 'sql_count': 394, 'condition_count': {'orderBy': 42, 'groupBy': 3, 'having': 1, 'nested': 6, 'join': 383}}, 'stand-up_comedy': {'avg_tokens': 78.30058939096267, 'num_tables': 38, 'num_columns': 206, 'sql_count': 509, 'condition_count': {'orderBy': 16, 'groupBy': 131, 'having': 32, 'nested': 45, 'join': 464}}, 'geology': {'avg_tokens': 66.46268656716418, 'num_tables': 19, 'num_columns': 83, 'sql_count': 134, 'condition_count': {'orderBy': 0, 'groupBy': 16, 'having': 1, 'nested': 6, 'join': 127}}, 'business_development': {'avg_tokens': 39.723214285714285, 'num_tables': 14, 'num_columns': 44, 'sql_count': 112, 'condition_count': {'orderBy': 29, 'groupBy': 36, 'having': 10, 'nested': 38, 'join': 62}}, 'comic_books': {'avg_tokens': 103.51351351351352, 'num_tables': 45, 'num_columns': 107, 'sql_count': 407, 'condition_count': {'orderBy': 152, 'groupBy': 174, 'having': 44, 'nested': 102, 'join': 400}}, 'drama_films': {'avg_tokens': 57.57377049180328, 'num_tables': 15, 'num_columns': 37, 'sql_count': 122, 'condition_count': {'orderBy': 32, 'groupBy': 83, 'having': 39, 'nested': 11, 'join': 118}}, 'information_security': {'avg_tokens': 68.56862745098039, 'num_tables': 21, 'num_columns': 47, 'sql_count': 51, 'condition_count': {'orderBy': 7, 'groupBy': 21, 'having': 9, 'nested': 15, 'join': 47}}, 'gardening': {'avg_tokens': 44.51520912547529, 'num_tables': 23, 'num_columns': 219, 'sql_count': 526, 'condition_count': {'orderBy': 10, 'groupBy': 18, 'having': 4, 'nested': 27, 'join': 211}}, 'virtual_reality': {'avg_tokens': 122.95846645367412, 'num_tables': 31, 'num_columns': 84, 'sql_count': 313, 'condition_count': {'orderBy': 68, 'groupBy': 70, 'having': 12, 'nested': 141, 'join': 246}}, 'craft_beer_brewing': {'avg_tokens': 68.23140495867769, 'num_tables': 23, 'num_columns': 55, 'sql_count': 121, 'condition_count': {'orderBy': 6, 'groupBy': 65, 'having': 24, 'nested': 57, 'join': 100}}, 'ui_ux_design': {'avg_tokens': 58.99175824175824, 'num_tables': 21, 'num_columns': 145, 'sql_count': 364, 'condition_count': {'orderBy': 42, 'groupBy': 127, 'having': 73, 'nested': 190, 'join': 296}}, 'botany': {'avg_tokens': 99.32, 'num_tables': 56, 'num_columns': 241, 'sql_count': 500, 'condition_count': {'orderBy': 11, 'groupBy': 19, 'having': 5, 'nested': 21, 'join': 390}}, 'screenwriting': {'avg_tokens': 31.367346938775512, 'num_tables': 13, 'num_columns': 36, 'sql_count': 98, 'condition_count': {'orderBy': 9, 'groupBy': 25, 'having': 14, 'nested': 22, 'join': 42}}, 'sports_medicine': {'avg_tokens': 57.9236641221374, 'num_tables': 33, 'num_columns': 200, 'sql_count': 131, 'condition_count': {'orderBy': 41, 'groupBy': 91, 'having': 20, 'nested': 13, 'join': 111}}, 'big_data': {'avg_tokens': 106.31428571428572, 'num_tables': 16, 'num_columns': 121, 'sql_count': 385, 'condition_count': {'orderBy': 12, 'groupBy': 220, 'having': 100, 'nested': 244, 'join': 344}}, 'musical_theater': {'avg_tokens': 75.50462107208872, 'num_tables': 39, 'num_columns': 239, 'sql_count': 541, 'condition_count': {'orderBy': 398, 'groupBy': 442, 'having': 70, 'nested': 28, 'join': 498}}, 'archaeology': {'avg_tokens': 58.99090909090909, 'num_tables': 28, 'num_columns': 133, 'sql_count': 110, 'condition_count': {'orderBy': 1, 'groupBy': 84, 'having': 3, 'nested': 0, 'join': 91}}, 'pilates': {'avg_tokens': 70.96041666666666, 'num_tables': 40, 'num_columns': 239, 'sql_count': 480, 'condition_count': {'orderBy': 149, 'groupBy': 334, 'having': 128, 'nested': 89, 'join': 413}}, 'data_mining': {'avg_tokens': 39.613995485327315, 'num_tables': 38, 'num_columns': 206, 'sql_count': 443, 'condition_count': {'orderBy': 52, 'groupBy': 177, 'having': 38, 'nested': 87, 'join': 223}}, 'marine_biology': {'avg_tokens': 43.89165186500888, 'num_tables': 30, 'num_columns': 216, 'sql_count': 563, 'condition_count': {'orderBy': 26, 'groupBy': 124, 'having': 3, 'nested': 14, 'join': 219}}, 'cosmetics_making': {'avg_tokens': 60.473794549266245, 'num_tables': 26, 'num_columns': 180, 'sql_count': 477, 'condition_count': {'orderBy': 129, 'groupBy': 242, 'having': 100, 'nested': 107, 'join': 412}}, 'mobile_app_design': {'avg_tokens': 80.5, 'num_tables': 18, 'num_columns': 34, 'sql_count': 108, 'condition_count': {'orderBy': 5, 'groupBy': 66, 'having': 50, 'nested': 53, 'join': 102}}, 'game_design': {'avg_tokens': 71.42736842105263, 'num_tables': 24, 'num_columns': 88, 'sql_count': 475, 'condition_count': {'orderBy': 7, 'groupBy': 57, 'having': 51, 'nested': 4, 'join': 355}}, 'high-speed_trains': {'avg_tokens': 47.72115384615385, 'num_tables': 29, 'num_columns': 281, 'sql_count': 104, 'condition_count': {'orderBy': 14, 'groupBy': 23, 'having': 4, 'nested': 9, 'join': 33}}, 'cardiovascular_training': {'avg_tokens': 31.133333333333333, 'num_tables': 15, 'num_columns': 38, 'sql_count': 75, 'condition_count': {'orderBy': 0, 'groupBy': 0, 'having': 0, 'nested': 29, 'join': 15}}, 'documentary_films': {'avg_tokens': 86.6829268292683, 'num_tables': 43, 'num_columns': 182, 'sql_count': 492, 'condition_count': {'orderBy': 9, 'groupBy': 15, 'having': 3, 'nested': 5, 'join': 403}}, 'business': {'avg_tokens': 81.501953125, 'num_tables': 36, 'num_columns': 226, 'sql_count': 512, 'condition_count': {'orderBy': 375, 'groupBy': 396, 'having': 95, 'nested': 32, 'join': 443}}, 'entomology': {'avg_tokens': 93.86190476190477, 'num_tables': 23, 'num_columns': 131, 'sql_count': 210, 'condition_count': {'orderBy': 62, 'groupBy': 74, 'having': 19, 'nested': 2, 'join': 192}}, 'data_analytics': {'avg_tokens': 70.15189873417721, 'num_tables': 27, 'num_columns': 62, 'sql_count': 237, 'condition_count': {'orderBy': 28, 'groupBy': 194, 'having': 68, 'nested': 8, 'join': 237}}, 'agriculture': {'avg_tokens': 59.526881720430104, 'num_tables': 13, 'num_columns': 67, 'sql_count': 186, 'condition_count': {'orderBy': 30, 'groupBy': 110, 'having': 55, 'nested': 73, 'join': 131}}, 'soapstone_carving': {'avg_tokens': 70.12338858195211, 'num_tables': 26, 'num_columns': 153, 'sql_count': 543, 'condition_count': {'orderBy': 326, 'groupBy': 405, 'having': 67, 'nested': 41, 'join': 443}}, 'boxing': {'avg_tokens': 83.93333333333334, 'num_tables': 17, 'num_columns': 71, 'sql_count': 120, 'condition_count': {'orderBy': 1, 'groupBy': 91, 'having': 35, 'nested': 31, 'join': 118}}, 'leadership': {'avg_tokens': 78.41233766233766, 'num_tables': 42, 'num_columns': 232, 'sql_count': 308, 'condition_count': {'orderBy': 78, 'groupBy': 100, 'having': 8, 'nested': 18, 'join': 249}}, 'sustainability': {'avg_tokens': 95.42560553633218, 'num_tables': 27, 'num_columns': 144, 'sql_count': 289, 'condition_count': {'orderBy': 210, 'groupBy': 234, 'having': 63, 'nested': 55, 'join': 272}}, 'athletic_training': {'avg_tokens': 94.0730593607306, 'num_tables': 47, 'num_columns': 300, 'sql_count': 438, 'condition_count': {'orderBy': 68, 'groupBy': 298, 'having': 183, 'nested': 194, 'join': 388}}, 'interior_design': {'avg_tokens': 56.31404958677686, 'num_tables': 22, 'num_columns': 54, 'sql_count': 121, 'condition_count': {'orderBy': 78, 'groupBy': 82, 'having': 60, 'nested': 28, 'join': 105}}, 'talk_shows': {'avg_tokens': 81.28070175438596, 'num_tables': 12, 'num_columns': 51, 'sql_count': 171, 'condition_count': {'orderBy': 68, 'groupBy': 111, 'having': 66, 'nested': 88, 'join': 166}}, 'volleyball': {'avg_tokens': 140.7431693989071, 'num_tables': 23, 'num_columns': 61, 'sql_count': 549, 'condition_count': {'orderBy': 2, 'groupBy': 527, 'having': 518, 'nested': 24, 'join': 547}}, 'makeup_artistry': {'avg_tokens': 63.06060606060606, 'num_tables': 36, 'num_columns': 236, 'sql_count': 198, 'condition_count': {'orderBy': 86, 'groupBy': 135, 'having': 28, 'nested': 24, 'join': 162}}, 'coaching': {'avg_tokens': 40.443697478991595, 'num_tables': 24, 'num_columns': 159, 'sql_count': 595, 'condition_count': {'orderBy': 43, 'groupBy': 83, 'having': 17, 'nested': 34, 'join': 277}}, 'tv_shows': {'avg_tokens': 98.33707865168539, 'num_tables': 63, 'num_columns': 245, 'sql_count': 356, 'condition_count': {'orderBy': 10, 'groupBy': 144, 'having': 133, 'nested': 206, 'join': 301}}, 'augmented_reality': {'avg_tokens': 45.3421052631579, 'num_tables': 46, 'num_columns': 238, 'sql_count': 114, 'condition_count': {'orderBy': 32, 'groupBy': 64, 'having': 6, 'nested': 15, 'join': 56}}, 'anthropology': {'avg_tokens': 66.04255319148936, 'num_tables': 19, 'num_columns': 62, 'sql_count': 141, 'condition_count': {'orderBy': 15, 'groupBy': 43, 'having': 21, 'nested': 0, 'join': 127}}, 'business_books': {'avg_tokens': 84.71030042918454, 'num_tables': 35, 'num_columns': 166, 'sql_count': 466, 'condition_count': {'orderBy': 295, 'groupBy': 365, 'having': 25, 'nested': 25, 'join': 405}}, 'horror_films': {'avg_tokens': 97.93159609120521, 'num_tables': 56, 'num_columns': 201, 'sql_count': 307, 'condition_count': {'orderBy': 240, 'groupBy': 207, 'having': 59, 'nested': 12, 'join': 234}}, 'electronic_music': {'avg_tokens': 77.93483709273183, 'num_tables': 33, 'num_columns': 72, 'sql_count': 399, 'condition_count': {'orderBy': 112, 'groupBy': 322, 'having': 233, 'nested': 97, 'join': 394}}, 'sociology': {'avg_tokens': 92.0304347826087, 'num_tables': 28, 'num_columns': 76, 'sql_count': 230, 'condition_count': {'orderBy': 4, 'groupBy': 182, 'having': 98, 'nested': 120, 'join': 210}}, 'psychology_books': {'avg_tokens': 86.65876777251185, 'num_tables': 16, 'num_columns': 105, 'sql_count': 422, 'condition_count': {'orderBy': 205, 'groupBy': 252, 'having': 104, 'nested': 110, 'join': 392}}, 'energy_management': {'avg_tokens': 37.725806451612904, 'num_tables': 10, 'num_columns': 42, 'sql_count': 62, 'condition_count': {'orderBy': 22, 'groupBy': 23, 'having': 1, 'nested': 2, 'join': 0}}, 'news_programs': {'avg_tokens': 97.97849462365592, 'num_tables': 32, 'num_columns': 81, 'sql_count': 279, 'condition_count': {'orderBy': 25, 'groupBy': 89, 'having': 57, 'nested': 203, 'join': 246}}, 'country_music': {'avg_tokens': 60.895890410958906, 'num_tables': 31, 'num_columns': 59, 'sql_count': 365, 'condition_count': {'orderBy': 202, 'groupBy': 160, 'having': 67, 'nested': 46, 'join': 351}}, 'chiropractic': {'avg_tokens': 103.82035928143712, 'num_tables': 17, 'num_columns': 60, 'sql_count': 167, 'condition_count': {'orderBy': 0, 'groupBy': 0, 'having': 0, 'nested': 0, 'join': 166}}, 'developmental_psychology': {'avg_tokens': 90.43450479233226, 'num_tables': 22, 'num_columns': 77, 'sql_count': 313, 'condition_count': {'orderBy': 62, 'groupBy': 103, 'having': 19, 'nested': 106, 'join': 300}}, 'political_science': {'avg_tokens': 38.54703832752613, 'num_tables': 29, 'num_columns': 165, 'sql_count': 287, 'condition_count': {'orderBy': 125, 'groupBy': 77, 'having': 17, 'nested': 110, 'join': 71}}, 'sports_psychology': {'avg_tokens': 100.74709976798144, 'num_tables': 26, 'num_columns': 158, 'sql_count': 431, 'condition_count': {'orderBy': 128, 'groupBy': 116, 'having': 8, 'nested': 36, 'join': 360}}, 'tai_chi': {'avg_tokens': 85.71348314606742, 'num_tables': 13, 'num_columns': 57, 'sql_count': 178, 'condition_count': {'orderBy': 1, 'groupBy': 31, 'having': 24, 'nested': 51, 'join': 173}}, 'energy': {'avg_tokens': 50.63522012578616, 'num_tables': 19, 'num_columns': 120, 'sql_count': 477, 'condition_count': {'orderBy': 5, 'groupBy': 133, 'having': 0, 'nested': 30, 'join': 141}}, 'fitness_instruction': {'avg_tokens': 38.02325581395349, 'num_tables': 30, 'num_columns': 242, 'sql_count': 43, 'condition_count': {'orderBy': 14, 'groupBy': 26, 'having': 2, 'nested': 0, 'join': 31}}, 'corporate_social_responsibility': {'avg_tokens': 76.6875, 'num_tables': 13, 'num_columns': 64, 'sql_count': 192, 'condition_count': {'orderBy': 1, 'groupBy': 131, 'having': 3, 'nested': 12, 'join': 177}}, 'genetics': {'avg_tokens': 64.12253829321664, 'num_tables': 43, 'num_columns': 207, 'sql_count': 457, 'condition_count': {'orderBy': 3, 'groupBy': 8, 'having': 6, 'nested': 11, 'join': 421}}}'''

data_dict = json.loads(data)

output = ''
for category, stats in data_dict.items():
    line = "{} & {} & {} & {} & {} & {} & {} & {} & {} & {} \\\\".format(
        category.capitalize(),
        round(stats['avg_tokens']),
        stats['num_tables'],
        stats['num_columns'],
        stats['sql_count'],
        stats['condition_count']['orderBy'],
        stats['condition_count']['groupBy'],
        stats['condition_count']['having'],
        stats['condition_count']['nested'],
        stats['condition_count']['join']
    )
    output += line + '\n'

print(output)
